name: Check Deleted Files

on:
  pull_request:
    branches:
      - main
      - develop
  push:
    branches:
      - main
      - develop

jobs:
  check-deleted-files:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ì „ì²´ íˆìŠ¤í† ë¦¬ ê°€ì ¸ì˜¤ê¸°
      
      - name: Check for deleted files
        run: |
          echo "ğŸ” ì‚­ì œëœ íŒŒì¼ ê²€ì¦ ì¤‘..."
          
          # ì‚­ì œëœ íŒŒì¼ ëª©ë¡
          DELETED_FILES=(
            "apps/web/public/brand/bioinsight-icon.PNG"
            "apps/web/public/brand/bioinsight-icon.svg"
          )
          
          # PRì¸ ê²½ìš° baseì™€ head ë¹„êµ, pushì¸ ê²½ìš° ì´ì „ ì»¤ë°‹ê³¼ ë¹„êµ
          if [ "${{ github.event_name }}" == "pull_request" ]; then
            BASE_SHA="${{ github.event.pull_request.base.sha }}"
            HEAD_SHA="${{ github.event.pull_request.head.sha }}"
            DIFF_CMD="git diff --name-only $BASE_SHA $HEAD_SHA"
          else
            DIFF_CMD="git diff --name-only HEAD~1 HEAD"
          fi
          
          FAILED=0
          for file in "${DELETED_FILES[@]}"; do
            if $DIFF_CMD | grep -q "^$file$"; then
              echo "âŒ ERROR: ì‚­ì œëœ íŒŒì¼ '$file'ì´ ë‹¤ì‹œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!"
              echo "ì´ íŒŒì¼ì€ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Bio-Insight.pngë¥¼ ì‚¬ìš©í•˜ì„¸ìš”."
              FAILED=1
            fi
          done
          
          if [ $FAILED -eq 1 ]; then
            exit 1
          fi
          
          echo "âœ… ì‚­ì œëœ íŒŒì¼ ê²€ì¦ í†µê³¼"

